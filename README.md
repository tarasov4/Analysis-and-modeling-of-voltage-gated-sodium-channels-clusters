# Analysis-and-modeling-of-voltage-gated-sodium-channels-clusters
The code used in the manuscript: Tarasov et al. Clustering Dynamically Modulate the Biophysics of Voltage-Gated Sodium Channels: How Nanoscale Phenomena Determine Health and Disease. bioRxiv 2025.05.31.657169; doi: https://doi.org/10.1101/2025.05.31.657169

**Cell-attached recordings analysis**: contains functions to (1) load patch-clamp recording from .abf file, (2) adjust baseline of current sweeps, (3) measure single-channel amplitudes by fitting gaussian mixture distributions to all current amplitudes, (4) subtracting capacitive transient currents, (5) de-noisation (idealization) of current sweeps using the Viterbi algorithm, (6) plotting current sweeps, (7) ensemble averaging idealized current sweeps, (8) calculation of mean late sodium current by normalization to peak sodium currents in idealized current sweeps, (9) fitting ensemble-average peak sodium current decay to the exponential functions to estimate the time constant of peak current decay.
**Quantification of functional interaction between channels**: contains functions to (1) fitting mean-variance relations in numbers of open channels to the binomial mean-variance relations, (2) calculation of Kullback–Leibler divergence and (3) variance-to-mean ratio (coefficient of dispersion) in numbers of open channels based on idealized current sweeps.
**Bayesian inference of the hidden Markov model parameters for currents idealization**: contains code for (1) loading, visualization and selection of single channel current sweeps used for subsequent inference, (2) Bayesian model for inference of the hidden Markov model parameters, (4) sampling the hidden Markov model parameters using tensorflow-probability’s NUTS sampler. 
